{% extends 'main/base.html' %}
{% load static %}
{% load i18n %}
{% block title %}{% trans "Accueil" %} - {{ site_brand.title_suffix }}{% endblock %}
{% block head %}
    <link rel="preload" as="style" href="{% static 'css/home-webchat-form.css' %}?v=16">
    <link rel="stylesheet" href="{% static 'css/home-webchat-form.css' %}?v=16">

        <!-- LCP: preload the SAME resource the <picture> will select (prevents LCP load delay) -->
        <link rel="preload" as="image"
            href="{% static 'images/banner/bg-558.webp' %}"
            media="(max-width: 991px)"
            type="image/webp"
            fetchpriority="high">
        <link rel="preload" as="image"
            href="{% static 'images/banner/bg-1116.webp' %}"
            media="(min-width: 992px)"
            type="image/webp"
            fetchpriority="high">
    <link rel="preload" as="style" href="{% static 'css/swiper.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/swiper.min.css' %}">

    <style>
        /* LCP: render hero background as an <img> so fetchpriority applies */
        .banner.banner--style3.bg_img { position: relative; background-image: none !important; }
        .banner.banner--style3 .banner-bg {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 0;
        }
        .banner.banner--style3 .banner-bg-wrap {
            position: absolute;
            inset: 0;
            z-index: 0;
        }
        .banner.banner--style3 > .container { position: relative; z-index: 1; }

        .banner__brand {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 14px;
        }
        .banner__brand img {
            width: 56px;
            height: 56px;
        }
        .banner__brand-name {
            font-weight: 800;
            letter-spacing: -0.02em;
            color: inherit;
            line-height: 1;
        }

        .story__slider {
            padding: 8px 6px 24px;
        }
        .story__slider .swiper-slide {
            height: auto;
        }
        .story-card-wrap {
            container-type: inline-size;
            container-name: story-card;
            background: rgba(255, 255, 255, 0.06);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 18px;
            box-shadow: 0 18px 40px rgba(8, 12, 30, 0.22);
            overflow: hidden;
            height: 100%;
            transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
        }
        .story-card-wrap:hover {
            transform: translateY(-6px);
            box-shadow: 0 22px 46px rgba(8, 12, 30, 0.3);
            border-color: rgba(255, 255, 255, 0.35);
        }
        .story-card {
            background: #0f172a;
            color: #e2e8f0;
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .story-card__image {
            position: relative;
            width: 100%;
        }
        .story-card__image a {
            display: block;
            width: 100%;
            height: 100%;
        }
        .story-card__image img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            display: block;
        }
        .story-card__content {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            flex: 1 1 auto;
        }
        .story-card__badge {
            background: rgba(56, 189, 248, 0.18);
            color: #7dd3fc;
            padding: 4px 12px;
            border-radius: 999px;
            font-size: 12px;
            font-weight: 600;
            align-self: flex-start;
        }
        .story-card__title {
            margin: 0;
            line-height: 1.15;
            font-size: clamp(1.25rem, 6cqi, 2.6rem);
            font-weight: 800;
            color: #f8fafc;
            transition: font-size 0.2s ease;
        }
        .story-card__desc {
            font-size: 1rem;
            line-height: 1.6;
            color: #cbd5e1;
            margin: 0;
        }
        .story-card__footer {
            margin-top: auto;
            padding-top: 20px;
            border-top: 1px solid rgba(148, 163, 184, 0.35);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }
        .story-card__author {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            font-weight: 600;
            color: #e2e8f0;
        }
        .story-card__author img {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            object-fit: cover;
        }
        .story-card__btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            background: #0ea5e9;
            color: #fff;
            border: none;
            padding: 10px 18px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            font-size: 14px;
            transition: background 0.2s ease, transform 0.2s ease;
            white-space: nowrap;
        }
        .story-card__btn:hover {
            background: #0284c7;
            color: #fff;
            transform: translateY(-1px);
        }
        .story__nav {
            display: inline-flex;
            gap: 12px;
            padding: 8px 12px;
            border-radius: 999px;
            background: rgba(15, 18, 35, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.12);
        }
        .story__prev,
        .story__next {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            transition: background 0.2s ease, transform 0.2s ease;
        }
        .story__prev:hover,
        .story__next:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-1px);
        }
        .story__slider .swiper-pagination-bullet {
            background: rgba(255, 255, 255, 0.4);
            opacity: 1;
        }
        .story__slider .swiper-pagination-bullet-active {
            background: #ff9b3f;
        }
        @container story-card (min-width: 480px) {
            .story-card {
                flex-direction: row;
                align-items: stretch;
            }
            .story-card__image {
                flex: 0 0 40%;
            }
            .story-card__image img {
                height: 100%;
            }
            .story-card__content {
                justify-content: center;
                padding: 26px;
            }
        }
        @container story-card (min-width: 750px) {
            .story-card {
                background: linear-gradient(to right, #0f172a, #111e36);
            }
            .story-card__image {
                flex: 0 0 50%;
            }
            .story-card__title {
                font-size: 5cqi;
                color: #7dd3fc;
            }
            .story-card__desc {
                font-size: 1.125rem;
            }
            .story-card__btn {
                background: #38bdf8;
                padding: 12px 22px;
            }
            .story-card__btn:hover {
                background: #0ea5e9;
            }
        }
    </style>

    <script nonce="{{ request.csp_nonce }}" defer src="{% static 'js/home-webchat-cities.js' %}?v=2"></script>
    <script nonce="{{ request.csp_nonce }}" defer src="{% static 'js/home-webchat-irc-token.js' %}?v=3"></script>
{% endblock %}
{% block content %}
    <!-- ================> Banner section start here <================== -->
    <div class="banner banner--style3 padding-top bg_img">
        <picture class="banner-bg-wrap" aria-hidden="true">
            <source
                type="image/webp"
                srcset="{% static 'images/banner/bg-558.webp' %} 558w, {% static 'images/banner/bg-1116.webp' %} 1116w"
                sizes="100vw"
            >
            <img
                class="banner-bg"
                src="{% static 'images/banner/bg.jpg' %}"
                width="1116"
                height="563"
                alt=""
                aria-hidden="true"
                fetchpriority="high"
                loading="eager"
                decoding="async"
            >
        </picture>
        
        <div class="container">
            <div class="row g-0 justify-content-center justify-content-xl-between">
                <div class="col-lg-5 col-12 wow fadeInLeft" data-wow-duration="1.5s">
                    <div class="banner__content">
                        <div class="banner__title">
                            <div class="banner__brand">
                                <img
                                    src="{% static site_brand.logo_url %}"
                                    width="56"
                                    height="56"
                                    alt="{% blocktrans with site_name=site_brand.site_name %}Logo {{ site_name }}{% endblocktrans %}"
                                    decoding="async"
                                >
                                <span class="banner__brand-name">{{ site_brand.site_name }}</span>
                            </div>
                            <h2>{% trans "Le tchat IRC" %}<span>{% trans "pour" %}</span> {% trans "connecter tout le monde." %}</h2>
                            <p>{% trans "Discute gratuitement, en temps réel, avec des personnes près de chez toi — ou à l’autre bout du monde." %}</p>
                            <a href="#" class="default-btn style-2"><span>{% trans "Rejoindre le tchat en un clic" %}</span></a>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 col-12 wow fadeInUp" data-wow-duration="1.5s">
                    <div class="banner__thumb text-xl-end">
                        <picture>
                            <source
                                type="image/webp"
                                srcset="{% static 'images/banner/03-558.webp' %} 558w, {% static 'images/banner/03-1116.webp' %} 1116w"
                                sizes="(max-width: 991px) 80vw, 558px"
                            >
                            <img
                                src="{% static 'images/banner/03.png' %}"
                                alt="{% trans "Illustration du tchat" %}"
                                width="558"
                                height="576"
                                decoding="async"
                            >
                        </picture>
                        <div class="banner__thumb--shape">
                            <div class="shapeimg">
                                <img src="{% static 'images/banner/shape/home3/01.png' %}" width="247" height="178" alt="{% trans "Décoration" %}" loading="lazy" decoding="async">
                            </div>
                        </div>
                        <div class="banner__thumb--title">
                            <h4 class="m-0">{% trans "j'adore le tchat.." %}</h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- ================> Banner section end here <================== -->

    {% block page_vendor_scripts %}
        <script nonce="{{ request.csp_nonce }}" defer src="{% static 'js/swiper.min.js' %}"></script>
        <script nonce="{{ request.csp_nonce }}" defer src="{% static 'js/counterup.js' %}"></script>
        <script nonce="{{ request.csp_nonce }}">
            window.storySliderInstance = window.storySliderInstance || null;
            window.lastPostCount = window.lastPostCount ?? null;

            function initStorySlider() {
                const storySlider = document.querySelector('.story__slider');
                if (!storySlider || !window.Swiper) return;

                if (window.storySliderInstance) {
                    window.storySliderInstance.destroy();
                }

                window.storySliderInstance = new Swiper(storySlider, {
                    slidesPerView: 1,
                    spaceBetween: 24,
                    loop: false,
                    pagination: {
                        el: storySlider.querySelector('.swiper-pagination'),
                        clickable: true,
                    },
                    navigation: {
                        nextEl: storySlider.querySelector('.story__next'),
                        prevEl: storySlider.querySelector('.story__prev'),
                    },
                    breakpoints: {
                        576: { slidesPerView: 2 },
                        992: { slidesPerView: 3 },
                        1200: { slidesPerView: 4 },
                    },
                });
            }

            function checkForNewPosts() {
                fetch(window.location.href)
                .then(response => response.text())
                .then(html => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    const newPostCount = doc.querySelectorAll('.story__slider .swiper-slide').length;

                    if (window.lastPostCount === null) {
                        window.lastPostCount = newPostCount;
                    } else if (newPostCount > window.lastPostCount) {
                        const newSlider = doc.querySelector('.story__slider');
                        const oldSlider = document.querySelector('.story__slider');
                        
                        if (newSlider && oldSlider) {
                            oldSlider.innerHTML = newSlider.innerHTML;
                            window.lastPostCount = newPostCount;
                            if (window.Swiper) {
                                initStorySlider();
                            }
                        }
                    }
                })
                .catch(error => console.debug('Post check skipped'));
            }

            document.addEventListener('DOMContentLoaded', () => {
                document.querySelectorAll('[data-background]').forEach((el) => {
                    const bg = el.getAttribute('data-background');
                    if (!bg) return;
                    el.style.backgroundImage = `url('${bg}')`;
                });

                initStorySlider();

                // Check for new posts every 30 seconds
                setInterval(checkForNewPosts, 30000);
            });
        </script>
    {% endblock %}
    <div class="about about--style2 padding-top pt-xl-0">
		<div class="container">
			<div class="section__wrapper wow fadeInUp" data-wow-duration="1.5s">
				<div class="row g-0 justify-content-center row-cols-lg-2 row-cols-1">
					<div class="col">
						<div class="about__left">
							<div class="about__top">
                                <div class="about__content">
                                    <h3>{{ site_brand.site_name }}</h3>
                                <p>{% trans "Un tchat IRC moderne pour discuter librement avec une communauté bienveillante, à tout âge." %}</p>
								</div>
							</div>
							<div class="about__bottom">
								<div class="about__bottom--head">
                                    <p class="h5 m-0 fw-semibold">{% trans "Nouveaux membres" %}</p>
									<div class="about__bottom--navi">
										<div class="ragi-prev"><i class="fa-solid fa-chevron-left"></i></div>
										<div class="ragi-next active"><i class="fa-solid fa-chevron-right"></i></div>
									</div>
								</div>
								<div class="about__bottom--body">
									<div class="ragi__slider overflow-hidden">
										<div class="swiper-wrapper">
                                            {% for m in latest_members %}
                                                <div class="swiper-slide">
                                                    <div class="ragi__thumb">
                                                        <a href="{% url 'member_profile' username=m.username %}" title="{{ m.username }}">
                                                            <img
                                                                src="{% if m.avatar_thumb_100_url %}{{ m.avatar_thumb_100_url }}{% elif m.avatar_url %}{{ m.avatar_url }}{% else %}{% static 'images/default-avatar.svg' %}{% endif %}"
                                                                srcset="{{ m.avatar_thumb_100_url }} 100w, {{ m.avatar_thumb_320_url }} 320w, {{ m.avatar_url }} 1024w"
                                                                sizes="100px"
                                                                width="100"
                                                                height="100"
                                                                alt="{{ m.username }}"
                                                                loading="lazy"
                                                                decoding="async"
                                                                data-fallback-src="{% static 'images/default-avatar.svg' %}"
                                                            >
                                                        </a>
                                                    </div>
                                                </div>
                                            {% empty %}
                                                <div class="swiper-slide">
                                                    <div class="ragi__thumb">
                                                        <img src="{% static 'images/ragi/01.jpg' %}" width="100" height="100" alt="{% trans "Membre" %}" loading="lazy" decoding="async">
                                                    </div>
                                                </div>
                                            {% endfor %}
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col">
						<div class="about__right">
                            <div class="home-webchat-card" id="home-webchat">
                                <div class="home-webchat-title">
                                    <h3>{% trans "Entre sur le tchat maintenant" %}</h3>
                                    <p>{% trans "Choisis un pseudo et discute tout de suite — sans inscription, sans appli, sans prise de tête." %}</p>
                                </div>
                                <form action="{% url 'webchat' %}" method="GET" class="home-webchat-form" target="_blank" id="form-desktop">
                                    {% if user.is_authenticated %}{% csrf_token %}{% endif %}
                                    <div class="row g-3">
                                        <div class="col-lg-6 col-12">
										<label class="form-label" for="webchat-nick">{% trans "Pseudo" %}</label>
                                            <div class="home-webchat-field">
                                                <i class="bi bi-person"></i>
                                                <input
                                                    type="text"
                                                    id="webchat-nick"
                                                    name="nick"
                                                    class="home-webchat-input"
                                                    placeholder="{% if user.is_authenticated %}{{ user.username }}{% else %}{% trans "Entrer un pseudo" %}{% endif %}"
                                                    {% if user.is_authenticated %}value="{{ user.username }}"{% endif %}
                                                    pattern=".{3,}"
                                                    title="{% trans "Saisis un pseudo (3 caractères minimum)." %}"
                                                    required
                                                    autocomplete="username"
                                                >
                                            </div>
                                            <div class="home-webchat-hint">{% trans "3 caractères minimum." %}</div>
                                        </div>
                                        <div class="col-lg-6 col-12">
										<label class="form-label" for="webchat-sexe">{% trans "Genre" %}</label>
                                            <div class="home-webchat-field">
                                                <i class="bi bi-gender-ambiguous"></i>
                                                <select id="webchat-sexe" name="sexe" class="home-webchat-select">
											<option value="homme">{% trans "Homme" %}</option>
											<option value="femme" selected>{% trans "Femme" %}</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-lg-6 col-12">
										<label class="form-label" for="webchat-age">{% trans "Âge (optionnel)" %}</label>
                                            <div class="home-webchat-field">
                                                <i class="bi bi-calendar2-week"></i>
                                                <input
                                                    type="number"
                                                    id="webchat-age"
                                                    name="age"
                                                    class="home-webchat-input"
                                                    min="18"
                                                    max="99"
                                                    value="18"
                                                    inputmode="numeric"
                                                    placeholder="18"
                                                    autocomplete="off"
                                                >
                                            </div>
										<div class="home-webchat-hint">{% trans "Entre 18 et 99 ans." %}</div>
                                        </div>
                                        <div class="col-lg-6 col-12">
										<label class="form-label" for="webchat-ville">{% trans "Ville (optionnel)" %}</label>
                                            <div class="home-webchat-field">
                                                <i class="bi bi-geo-alt"></i>
                                                <input
                                                    type="text"
                                                    id="webchat-ville"
                                                    name="ville"
                                                    class="home-webchat-input"
                                                    placeholder="{% trans "Tape ta ville (ex. : Paris)" %}"
                                                    list="webchat-ville-list"
                                                    autocomplete="address-level2"
                                                    data-cities-endpoint="{% url 'get_cities' %}"
                                                >
                                                <datalist id="webchat-ville-list"></datalist>
                                                <div class="home-webchat-suggestions" id="webchat-ville-suggestions" hidden></div>
                                            </div>
										<div class="home-webchat-hint">{% trans "Tape au moins 2 lettres pour voir des suggestions." %}</div>
                                        </div>
                                        <div class="col-12">
										<label class="form-label" for="webchat-channel">{% trans "Salon IRC" %}</label>
                                            <div class="home-webchat-field">
                                                <i class="bi bi-hash"></i>
                                                <input
                                                    type="text"
                                                    id="webchat-channel"
                                                    name="channel"
                                                    class="home-webchat-input"
                                                    value="{{ request.webchat_channel_default }}"
                                                    placeholder="{{ request.webchat_channel_default }}"
                                                    autocomplete="off"
                                                >
                                            </div>
										<div class="home-webchat-hint">{% trans "Tu peux choisir un autre salon (ex. : #Tech, #Musique, #Gaming)." %}</div>
                                        </div>

                                        <input type="hidden" name="show_password" value="false">

                                        {% if user.is_authenticated %}
                                            <div class="col-12">
                                                <div class="home-webchat-toggle" role="group" aria-label="{% trans "Option mot de passe" %}">
                                                    <div class="home-webchat-toggle-row">
                                                        <div class="home-webchat-toggle-text">
												<div class="home-webchat-toggle-title">{% trans "Connexion sécurisée (token IRC)" %}</div>
                                                <div class="home-webchat-toggle-sub">{% trans "Active cette option pour générer un token IRC. Tu pourras le copier-coller dans le champ « mot de passe » du webchat." %}</div>
                                                        </div>
                                                        <label class="home-webchat-switch" for="webchat-show-password">
                                                            <input
                                                                class="home-webchat-switch-input"
                                                                type="checkbox"
                                                                id="webchat-show-password"
                                                                name="show_password"
                                                                value="true"
                                                                data-token-endpoint="{% url 'generate_irc_app_password' username=user.username %}"
                                                            >
                                                            <span class="home-webchat-switch-ui" aria-hidden="true"></span>
                                                        </label>
                                                    </div>

                                                    <div class="home-webchat-token" id="home-webchat-token" hidden>
                                                        <div class="home-webchat-token-head">
												<div class="home-webchat-token-title">{% trans "Ton token IRC (à copier)" %}</div>
												<button type="button" class="home-webchat-token-regenerate" id="home-webchat-token-regenerate">{% trans "Régénérer" %}</button>
                                                        </div>
                                                        <div class="home-webchat-token-row">
												<input type="password" class="home-webchat-token-input" id="home-webchat-token-input" value="" readonly autocomplete="off" spellcheck="false" aria-label="{% trans "Token IRC" %}">
												<button type="button" class="home-webchat-token-reveal" id="home-webchat-token-reveal" aria-pressed="false" aria-label="{% trans "Afficher/masquer le token" %}">{% trans "Afficher" %}</button>
												<button type="button" class="home-webchat-token-copy" id="home-webchat-token-copy">{% trans "Copier" %}</button>
                                                        </div>
												<div class="home-webchat-token-hint" id="home-webchat-token-hint">{% trans "Valable quelques instants et utilisable une seule fois. Colle-le dans le champ « mot de passe » du webchat une fois ouvert." %}</div>
                                                    </div>
                                                </div>
                                            </div>
                                        {% else %}
                                            <div class="col-12">
                                                <div class="home-webchat-token home-webchat-token--locked">
											<div class="home-webchat-token-title">{% trans "Mot de passe (membres)" %}</div>
											<div class="home-webchat-token-hint">{% trans "Disponible lorsque tu es connecté." %}</div>
                                                    <div class="home-webchat-token-actions">
												<a class="home-webchat-token-login" href="{% url 'login' %}?next={{ request.path|urlencode }}%23home-webchat" target="_self">{% trans "Se connecter" %}</a>
                                                    </div>
                                                </div>
                                            </div>
                                        {% endif %}

                                        <div class="col-12">
                                            <button type="submit" class="default-btn d-block home-webchat-submit">
										<span>{% trans "Ouvrir le webchat" %} <i class="bi bi-chat-dots"></i></span>
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<div class="about padding-top padding-bottom">
		<div class="container">
			<div class="section__header style-2 text-center wow fadeInUp" data-wow-duration="1.5s">
                <h2>{% trans "Tout commence dans un salon…" %}</h2>
                <p>{% trans "Un message, un sujet, une discussion. Ici, on vient pour échanger, apprendre, rire et créer du lien — entre jeunes, moins jeunes, et tout le monde entre les deux." %}</p>
			</div>
			<div class="section__wrapper">
				<div class="row g-4 justify-content-center row-cols-xl-4 row-cols-lg-3 row-cols-sm-2 row-cols-1">
					<div class="col wow fadeInUp" data-wow-duration="1.5s">
						<div class="about__item text-center">
							<div class="about__inner">
								<div class="about__thumb">
                                    <picture>
                                        <source type="image/webp" srcset="{% static 'images/about/icon/serveur-100.webp' %}">
                                        <img src="{% static 'images/about/icon/serveur.png' %}" width="100" height="100" alt="{% trans "Icône serveur" %}" loading="lazy" decoding="async">
                                    </picture>
								</div>
								<div class="about__content">
                                    <h3><span class="counter" data-to="{{ server_count }}" data-speed="1500">{{ server_count }}</span></h3>
									<p>{% trans "Serveurs IRC" %}</p>
                                </div>
							</div>
						</div>
					</div>
					<div class="col wow fadeInUp" data-wow-duration="1.6s">
						<div class="about__item text-center">
							<div class="about__inner">
								<div class="about__thumb">
                                    <picture>
                                        <source type="image/webp" srcset="{% static 'images/about/icon/utilisateurs-100.webp' %}">
                                        <img src="{% static 'images/about/icon/utilisateurs.png' %}" width="100" height="100" alt="{% trans "Icône utilisateurs" %}" loading="lazy" decoding="async">
                                    </picture>
								</div>
								<div class="about__content">
                                    <h3><span class="counter" data-to="{{ user_count }}" data-speed="1500">{{ user_count }}</span></h3>
									<p>{% trans "Membres" %}</p>
                                </div>
							</div>
						</div>
					</div>
					<div class="col wow fadeInUp" data-wow-duration="1.7s">
						<div class="about__item text-center">
							<div class="about__inner">
								<div class="about__thumb">
                                    <picture>
                                        <source type="image/webp" srcset="{% static 'images/about/icon/operateurs-100.webp' %}">
                                        <img src="{% static 'images/about/icon/operateurs.png' %}" width="100" height="100" alt="{% trans "Icône opérateurs" %}" loading="lazy" decoding="async">
                                    </picture>
								</div>
								<div class="about__content">
                                    <h3><span class="counter" data-to="{{ oper_count }}" data-speed="1500">{{ oper_count }}</span></h3>
									<p>{% trans "Opérateurs IRC" %}</p>
                                </div>                                
							</div>
						</div>
					</div>
					<div class="col wow fadeInUp" data-wow-duration="1.8s">
						<div class="about__item text-center">
							<div class="about__inner">
								<div class="about__thumb">
                                    <picture>
                                        <source type="image/webp" srcset="{% static 'images/about/icon/channels-100.webp' %}">
                                        <img src="{% static 'images/about/icon/channels.png' %}" width="100" height="100" alt="{% trans "Icône salons" %}" loading="lazy" decoding="async">
                                    </picture>
								</div>
								<div class="about__content">
                                    <h3><span class="counter" data-to="{{ channel_count }}" data-speed="1500">{{ channel_count }}</span></h3>
									<p>{% trans "Salons" %}</p>
                                </div>                                
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
    <!-- ================> About section end here <================== -->

    <!-- ================> Member section start here <================== -->
    <div class="member member--style3 padding-top padding-bottom" data-background="{% static 'images/banner/bg.jpg' %}">
        <div class="container">
            <div class="section__header style-2 text-center wow fadeInUp" data-wow-duration="1.5s">
                <h2>{% trans "La communauté" %}</h2>
                <p>{% trans "Des profils, des centres d’intérêt et des salons pour discuter. Ici, on privilégie les échanges simples, humains et respectueux." %}</p>
            </div>
            <div class="section__wrapper">
                <div class="row g-0 mx-12-none justify-content-center wow fadeInUp" data-wow-duration="1.5s">
                    {% for m in home_members %}
                    <div class="member__item">
                        <div class="member__inner">
                            <div class="member__thumb">
                                <a href="{% url 'member_profile' username=m.username %}" title="{{ m.username }}">
                                    <img
                                        src="{% if m.avatar_thumb_320_url %}{{ m.avatar_thumb_320_url }}{% elif m.avatar_url %}{{ m.avatar_url }}{% else %}{% static 'images/default-avatar.svg' %}{% endif %}"
                                        srcset="{{ m.avatar_thumb_100_url }} 100w, {{ m.avatar_thumb_320_url }} 320w, {{ m.avatar_url }} 1024w"
                                        sizes="(max-width: 991px) 45vw, 261px"
                                        width="261"
                                        height="261"
                                        alt="{{ m.username }}"
                                        loading="lazy"
                                        decoding="async"
                                        data-fallback-src="{% static 'images/default-avatar.svg' %}"
                                    >
                                </a>
                            </div>
                            <div class="member__content">
								<a href="{% url 'member_profile' username=m.username %}"><span class="h5 d-inline-block mb-0">{{ m.username }}</span></a>
                                <p>
                                    {% if m.last_login %}
                                        {% with last_seen=m.last_login|timesince %}
                                            {% if last_seen %}
                                                {% trans "Dernière activité" %} {% blocktrans %}il y a {{ last_seen }}{% endblocktrans %}
                                            {% else %}
                                                {% trans "Dernière activité" %} {% trans "à l'instant" %}
                                            {% endif %}
                                        {% endwith %}
                                    {% else %}
                                        {% trans "Nouveau membre" %}
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                    </div>
                    {% empty %}
					<p class="text-center text-muted">{% trans "Aucun profil à afficher pour le moment." %}</p>
                    {% endfor %}
                </div>
                <div class="text-center mt-4 wow fadeInUp" data-wow-duration="2s">
				<a href="{% url 'community_membres' %}" class="default-btn"><span>{% trans "Voir la communauté" %} <i class="ms-2 fas fa-users"></i></span></a>
                </div>
            </div>
        </div>
    </div>
    <!-- ================> Member section end here <================== -->

   

    <!-- ================> Work section start here <================== -->
    <div class="work padding-top padding-bottom bg_img" data-background="{% static 'images/banner/bg.jpg' %}">
        <div class="container">
            <div class="section__header text-center wow fadeInUp" data-wow-duration="1.5s">
                <h2>
                    {% blocktrans trimmed with site_name=site_brand.site_name %}
                        Pourquoi choisir {{ site_name }} ?
                    {% endblocktrans %}
                </h2>
            </div>
            <div class="section__wrapper wow fadeInUp" data-wow-duration="1.5s">
                <div class="d-xl-flex align-items-start work__area">
                    <div class="nav flex-xl-column nav-pills me-xl-4 work__tablist" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                        <button class="nav-link" id="work__tab1-tab" data-bs-toggle="pill" data-bs-target="#work__tab1" type="button" role="tab" aria-controls="work__tab1" aria-selected="true"><img src="{% static 'images/work/01.png' %}" width="40" height="40" alt="{% trans "Illustration" %}" class="me-3" decoding="async"><span>{% trans "Choisis ton pseudo" %}</span></button>
                        <button class="nav-link active" id="work__tab2-tab" data-bs-toggle="pill" data-bs-target="#work__tab2" type="button" role="tab" aria-controls="work__tab2" aria-selected="false"><img src="{% static 'images/work/02.png' %}" width="40" height="40" alt="{% trans "Illustration" %}" class="me-3" decoding="async"><span>{% trans "Des gens, pas des bots" %}</span></button>
                        <button class="nav-link" id="work__tab3-tab" data-bs-toggle="pill" data-bs-target="#work__tab3" type="button" role="tab" aria-controls="work__tab3" aria-selected="false"><img src="{% static 'images/work/03.png' %}" width="40" height="40" alt="{% trans "Illustration" %}" class="me-3" decoding="async"><span>{% trans "Trouve ton salon" %}</span></button>
                        <button class="nav-link" id="work__tab4-tab" data-bs-toggle="pill" data-bs-target="#work__tab4" type="button" role="tab" aria-controls="work__tab4" aria-selected="false"><img src="{% static 'images/work/04.png' %}" width="36" height="40" alt="{% trans "Illustration" %}" class="me-3" decoding="async"><span>{% trans "Crée des liens" %}</span></button>
                    </div>
                    <div class="tab-content work__tabcontent" id="v-pills-tabContent">
                        <div class="tab-pane fade" id="work__tab1" role="tabpanel" aria-labelledby="work__tab1-tab">
                            <div class="work__item">
                                <div class="work__inner">
                                    <div class="work__thumb">
                                        <img src="{% static 'images/work/05.png' %}" width="261" height="244" alt="{% trans "Illustration" %}" loading="lazy" decoding="async">
                                    </div>
                                    <div class="work__content">
                                        <h3>{% trans "Choisis ton pseudo" %}</h3>
									<p>{% blocktrans with site_name=site_brand.site_name %}Avec {{ site_name }}, tu entres dans le tchat en quelques secondes : un pseudo, un salon, et c’est parti. Simple, rapide, efficace.{% endblocktrans %}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade show active" id="work__tab2" role="tabpanel" aria-labelledby="work__tab2-tab">
                            <div class="work__item">
                                <div class="work__inner">
                                    <div class="work__thumb">
                                        <picture>
                                            <source type="image/webp" srcset="{% static 'images/work/06.webp' %}">
                                            <img src="{% static 'images/work/06.png' %}" width="261" height="244" alt="{% trans "Illustration" %}" loading="lazy" decoding="async">
                                        </picture>
                                    </div>
                                    <div class="work__content">
                                        <h3>{% trans "Des gens, pas des bots" %}</h3>
									<p>{% blocktrans with site_name=site_brand.site_name %}Sur {{ site_name }}, on favorise les vraies discussions : moins de bruit, plus d’échanges. Anti-spam et modération pour garder une ambiance saine.{% endblocktrans %}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="work__tab3" role="tabpanel" aria-labelledby="work__tab3-tab">
                            <div class="work__item">
                                <div class="work__inner">
                                    <div class="work__thumb">
                                        <img src="{% static 'images/work/07.png' %}" width="261" height="244" alt="{% trans "Illustration" %}" loading="lazy" decoding="async">
                                    </div>
                                    <div class="work__content">
                                        <h3>{% trans "Trouve ton salon" %}</h3>
									<p>{% trans "Du général aux passions : musique, tech, jeux, entraide… Rejoins un salon, ou crée le tien en 10 secondes." %}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="work__tab4" role="tabpanel" aria-labelledby="work__tab4-tab">
                            <div class="work__item">
                                <div class="work__inner">
                                    <div class="work__thumb">
                                        <img src="{% static 'images/work/08.png' %}" width="261" height="244" alt="{% trans "Illustration" %}" loading="lazy" decoding="async">
                                    </div>
                                    <div class="work__content">
                                        <h3>{% trans "Crée des liens" %}</h3>
									<p>{% trans "Des discussions simples, des gens de tous âges, des sujets qui rassemblent. Viens pour parler, reste pour la vibe." %}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- ================> Work section end here <================== -->

   <!-- ================> Story section start here <================== -->
<div class="story padding-top padding-bottom" data-background="{% static 'images/banner/bg.jpg' %}">
    <div class="container">
        <div class="section__header style-2 text-center wow fadeInUp" data-wow-duration="1.5s">
            <h2>{% trans "Le blog" %}</h2>
			<p>{% trans "Actus, coulisses, guides et idées de salons — pour mieux discuter." %}</p>
        </div>
        <div class="section__wrapper wow fadeInUp" data-wow-duration="2s">
            {% if posts %}
                <div class="swiper story__slider">
                    <div class="swiper-wrapper">
                        {% for post in posts %}
                            <div class="swiper-slide">
                                <div class="story-card-wrap">
                                    <article class="story-card">
                                        <div class="story-card__image">
                                            <a href="{% url 'blog:blog_detail' slug=post.slug %}">
                                                <img
                                                    src="{{ post.image_thumb_326_url|default:post.image.url }}"
                                                    srcset="{{ post.image_thumb_326_url }} 326w, {{ post.image_thumb_652_url }} 652w, {{ post.image.url }} 1200w"
                                                    sizes="(max-width: 991px) 90vw, 326px"
                                                    width="326"
                                                    height="326"
                                                    alt="{{ post.title }}"
                                                    loading="lazy"
                                                    decoding="async"
                                                >
                                            </a>
                                        </div>
                                        <div class="story-card__content">
                                            <span class="story-card__badge">{{ post.category }}</span>
                                            <a href="{% url 'blog:blog_detail' slug=post.slug %}">
                                                <h3 class="story-card__title">{{ post.title }}</h3>
                                            </a>
                                            <p class="story-card__desc">
                                                {% if post.excerpt %}
                                                    {{ post.excerpt|striptags|truncatechars:140 }}
                                                {% elif post.content %}
                                                    {{ post.content|striptags|truncatechars:140 }}
                                                {% else %}
                                                    {% trans "Lire la suite pour decouvrir l'article." %}
                                                {% endif %}
                                            </p>
                                            <div class="story-card__footer">
                                                <div class="story-card__author">
                                                    <img
                                                        src="{% if post.author.avatar_thumb_100_url %}{{ post.author.avatar_thumb_100_url }}{% elif post.author.avatar_url %}{{ post.author.avatar_url }}{% else %}{% static 'images/default-avatar.svg' %}{% endif %}"
                                                        srcset="{{ post.author.avatar_thumb_100_url }} 100w, {{ post.author.avatar_thumb_320_url }} 320w, {{ post.author.avatar_url }} 1024w"
                                                        sizes="32px"
                                                        width="32"
                                                        height="32"
                                                        alt="{{ post.author.username }}"
                                                        loading="lazy"
                                                        decoding="async"
                                                        data-fallback-src="{% static 'images/default-avatar.svg' %}"
                                                    >
                                                    <span>{{ post.author.username }}</span>
                                                </div>
                                                <a class="story-card__btn" href="{% url 'blog:blog_detail' slug=post.slug %}">
                                                    {% trans "Lire la suite" %}
                                                    <i class="fa-solid fa-arrow-right"></i>
                                                </a>
                                            </div>
                                        </div>
                                    </article>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    <div class="swiper-pagination"></div>
                    <div class="story__nav text-center mt-3">
                        <button class="story__prev" type="button" aria-label="Previous">
                            <i class="fa-solid fa-chevron-left"></i>
                        </button>
                        <button class="story__next" type="button" aria-label="Next">
                            <i class="fa-solid fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            {% else %}
				<p class="text-center text-muted">{% trans "Aucun article de blog disponible pour le moment." %}</p>
            {% endif %}
        </div>
    </div>
</div>
<!-- ================> Story section end here <================== -->

    <!-- ================> Work section start here <================== -->
    <div class="work work--style2 padding-top padding-bottom bg_img" data-background="{% static 'images/banner/bg.jpg' %}">
        <div class="container">
            <div class="section__wrapper">
                <div class="row g-4 justify-content-center">
                    <div class="col-xl-6 col-lg-8 col-12 wow fadeInLeft" data-wow-duration="1.5s">
                        <div class="work__item">
                            <div class="work__inner">
                                <div class="work__thumb">
                                    <img src="{% static 'images/work/09.png' %}" width="200" height="252" alt="{% trans "Illustration" %}" loading="lazy" decoding="async">
                                </div>
                                <div class="work__content">
                                    <h3>{% trans "Confiance & sécurité" %}</h3>
									<p>{% trans "Les échanges sont chiffrés (TLS/SSL) pour protéger tes données en transit. On préfère la simplicité, pas la surveillance." %}</p>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-6 col-lg-8 col-12 wow fadeInRight" data-wow-duration="1.5s">
                        <div class="work__item">
                            <div class="work__inner">
                                <div class="work__thumb">
                                    <img src="{% static 'images/work/09.png' %}" width="200" height="252" alt="{% trans "Illustration" %}" loading="lazy" decoding="async">
                                </div>
                                <div class="work__content">
                                    <h3>{% trans "Des salons pour tous" %}</h3>
									<p>{% trans "Des salons variés, des sujets du quotidien aux passions. Tu peux aussi créer ton propre salon et lancer la discussion." %}</p>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-6 col-lg-8 col-12 wow fadeInRight" data-wow-duration="1.5s">
                        <div class="work__item">
                            <div class="work__inner">
                                <div class="work__thumb">
                                    <img src="{% static 'images/work/09.png' %}" width="200" height="252" alt="{% trans "Illustration" %}" loading="lazy" decoding="async">
                                </div>
                                <div class="work__content">
                                    <h3>{% trans "Du monde à toute heure" %}</h3>
									<p>{% trans "Le tchat ne dort jamais : viens dire bonjour le matin, à la pause, ou tard le soir. Il y a toujours quelqu’un pour échanger." %}</p>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-6 col-lg-8 col-12 wow fadeInRight" data-wow-duration="1.5s">
                        <div class="work__item">
                            <div class="work__inner">
                                <div class="work__thumb">
                                    <img src="{% static 'images/work/09.png' %}" width="200" height="252" alt="{% trans "Illustration" %}" loading="lazy" decoding="async">
                                </div>
                                <div class="work__content">
                                    <h3>{% trans "Gratuit, simple, sans friction" %}</h3>
									<p>{% trans "Un espace pour discuter tranquillement 24/7. Rapide, simple, sans inscription obligatoire : tu entres, tu parles, tu restes si tu veux." %}</p>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- ================> Work section end here <================== -->
{% endblock %}
